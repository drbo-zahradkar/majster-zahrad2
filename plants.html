<!doctype html>
<html lang="sk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="favicon.jpg" type="image/jpg+xml">
  <title>EncyklopÃ©dia rastlÃ­n â€“ Majster zÃ¡hrady</title>
  <link rel="stylesheet" href="assets/styles.css" />
  <style>
    body { background: #f8f8f8; }
    .plant-card {
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      transition: transform 0.2s ease;
    }
    .plant-card:hover {
      transform: scale(1.02);
    }
    .plant-card img {
      width: 100%;
      height: 180px;
      object-fit: cover;
    }
    .plant-card h3 {
      margin: 8px 10px 0;
      font-size: 1.1em;
    }
    .plant-card .latin {
      margin: 0 10px 10px;
      font-size: 0.9em;
      color: #555;
      font-style: italic;
    }
    .cards-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
    }
    .filters {
      margin: 15px 0;
      position: relative;
    }
    .filter-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }
    .filter-row select, .filter-row input {
      flex: 1;
      min-width: 180px;
    }
    .autocomplete-list {
      position: absolute;
      top: 45px;
      left: 0;
      right: 0;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.15);
      max-height: 200px;
      overflow-y: auto;
      z-index: 10;
    }
    .autocomplete-item {
      padding: 8px 12px;
      cursor: pointer;
      border-bottom: 1px solid #eee;
    }
    .autocomplete-item:hover {
      background: #f0f0f0;
    }

    /* ===== SezÃ³nne tipy ===== */
    .season-box {
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      padding: 15px;
      margin-bottom: 25px;
    }
    .season-selector button {
      margin: 5px;
      padding: 6px 10px;
      border: none;
      border-radius: 6px;
      background: #dff0d8;
      cursor: pointer;
    }
    .season-selector button.active {
      background: #9fd89f;
      font-weight: bold;
    }
  </style>
</head>
<body data-page="plants">
<header class="site-header">
  <a class="logo" href="index.html"><span class="logo-mark">ğŸŒ±</span><span class="logo-text">Majster zÃ¡hrady</span></a>
  <nav class="site-nav">
    <a href="plants.html" aria-current="page">EncyklopÃ©dia</a>
    <a href="tips.html">SezÃ³nne tipy</a>
    <a href="planner.html">PlÃ¡novaÄ</a>
    <a href="quiz.html">KvÃ­z</a>
    <a href="karel.html">Karel</a>
  </nav>
  <div class="controls">
    <button class="btn ghost" id="themeToggle" aria-pressed="false">ğŸŒ“</button>
    <button class="btn ghost" id="accentCycle">ğŸ¨</button>
  </div>
</header>

<main class="container">
  <!-- âœ… PridanÃ© sezÃ³nne tipy -->
  <section class="season-box">
    <h2>ğŸŒ¿ SezÃ³nne tipy</h2>
    <div class="season-selector">
      <button data-season="jar">Jar</button>
      <button data-season="leto">Leto</button>
      <button data-season="jesen">JeseÅˆ</button>
      <button data-season="zima">Zima</button>
    </div>
    <div id="seasonContent"></div>
  </section>

  <header class="page-head">
    <h1>EncyklopÃ©dia rastlÃ­n</h1>
    <p>VyhÄ¾adÃ¡vaj rastliny podÄ¾a nÃ¡zvu alebo latinskÃ©ho mena. DÃ¡ta pochÃ¡dzajÃº z Trefle API.</p>
  </header>

  <section class="filters" aria-label="Filtre rastlÃ­n">
    <input id="plantSearch" class="input" type="search" placeholder="HÄ¾adaj nÃ¡zov alebo latinskÃ½ nÃ¡zovâ€¦" autocomplete="off" />
    <div id="autocomplete" class="autocomplete-list" style="display:none;"></div>
    <div class="filter-row">
      <select id="filterSun" class="select" aria-label="Filter slnko">
        <option value="">Svetlo (vÅ¡etko)</option>
        <option value="slneÄnÃ©">SlneÄnÃ©</option>
        <option value="polotieÅˆ">PolotieÅˆ</option>
        <option value="tieÅˆ">TieÅˆ</option>
      </select>
      <select id="filterWater" class="select" aria-label="Filter zÃ¡lievka">
        <option value="">ZÃ¡lievka (vÅ¡etko)</option>
        <option value="nÃ­zka">NÃ­zka</option>
        <option value="strednÃ¡">StrednÃ¡</option>
        <option value="vysokÃ¡">VysokÃ¡</option>
      </select>
      <select id="filterDifficulty" class="select" aria-label="Filter nÃ¡roÄnosÅ¥">
        <option value="">NÃ¡roÄnosÅ¥ (vÅ¡etko)</option>
        <option value="Ä¾ahkÃ¡">Ä½ahkÃ¡</option>
        <option value="strednÃ¡">StrednÃ¡</option>
        <option value="nÃ¡roÄnÃ¡">NÃ¡roÄnÃ¡</option>
      </select>
      <button id="resetFilters" class="btn">Reset</button>
    </div>
  </section>

  <section id="plantList" class="cards-grid" aria-live="polite">
    <p>Zadaj nÃ¡zov rastliny ğŸŒ¿</p>
  </section>
</main>

<footer class="site-footer"><p>Â© <span id="year"></span> Majster zÃ¡hrady</p></footer>

<script>
  const yearEl = document.getElementById('year');
  if (yearEl) yearEl.textContent = new Date().getFullYear();

  const list = document.getElementById('plantList');
  const searchInput = document.getElementById('plantSearch');
  const autocompleteBox = document.getElementById('autocomplete');

  const TOKEN = "usr-51E-rQa5pgTQmyLBFRNAINUXBDAmYyCAaBHAOD-LjZ8";
  let plants = [];

  async function searchPlants(q) {
    try {
      const res = await fetch(`https://proxy-pre-zahradkara-drba.onrender.com/plants?q=${q}`);
      const data = await res.json();
      plants = data.data.map(p => ({
        id: p.id,
        name: p.common_name || "NeznÃ¡ma rastlina",
        latin: p.scientific_name || "â€”",
        img: p.image_url || "https://via.placeholder.com/300x200?text=Bez+obrÃ¡zka"
      }));
      renderPlants(plants);
      showAutocomplete(plants);
    } catch (err) {
      console.error(err);
      list.innerHTML = "<p>Nepodarilo sa naÄÃ­taÅ¥ rastliny ğŸ˜¢</p>";
    }
  }

  function renderPlants(data) {
  list.innerHTML = '';
  if (data.length === 0) {
    list.innerHTML = '<p>NenaÅ¡li sa Å¾iadne rastliny.</p>';
    return;
  }
  data.forEach(plant => {
    const card = document.createElement('div');
    card.className = 'plant-card';
    card.dataset.id = plant.id;

    card.innerHTML = `
      <img src="${plant.img}" alt="${plant.name}">
      <h3>${plant.name}</h3>
      <div class="latin">${plant.latin}</div>
    `;

    card.addEventListener('click', () => {
  window.location.href = `plant.html?latin=${encodeURIComponent(plant.latin)}`;
});

    list.appendChild(card);
  });
}


  function showAutocomplete(suggestions) {
    if (suggestions.length === 0) {
      autocompleteBox.style.display = 'none';
      return;
    }
    autocompleteBox.innerHTML = '';
    suggestions.slice(0, 8).forEach(plant => {
      const item = document.createElement('div');
      item.className = 'autocomplete-item';
      item.textContent = plant.name;
      item.addEventListener('click', () => {
        searchInput.value = plant.name;
        renderPlants([plant]);
        autocompleteBox.style.display = 'none';
      });
      autocompleteBox.appendChild(item);
    });
    autocompleteBox.style.display = 'block';
  }

  searchInput.addEventListener('input', () => {
    const q = searchInput.value.toLowerCase().trim();
    if (q.length >= 2) {
      searchPlants(q);
    } else {
      autocompleteBox.style.display = 'none';
      list.innerHTML = '<p>Zadaj aspoÅˆ 2 pÃ­smenÃ¡ ğŸŒ¿</p>';
    }
  });

  document.addEventListener('click', (e) => {
    if (!autocompleteBox.contains(e.target) && e.target !== searchInput) {
      autocompleteBox.style.display = 'none';
    }
  });

  document.getElementById('resetFilters').addEventListener('click', () => {
    searchInput.value = '';
    autocompleteBox.style.display = 'none';
    list.innerHTML = '<p>Zadaj nÃ¡zov rastliny ğŸŒ¿</p>';
    plants = [];
  });

  // ===== SezÃ³nne tipy =====
  const tips = {
    jar: [
      "SadiÅ¥ zemiaky, mrkvu, cibuÄ¾u a hrÃ¡Å¡ok.",
      "PresÃ¡dzaÅ¥ trvalky a bylinky.",
      "PrerezÃ¡vaÅ¥ stromy a krÃ­ky po zime.",
      "PredpestovaÅ¥ rajÄiny a papriku."
    ],
    leto: [
      "ZalievaÅ¥ skoro rÃ¡no alebo veÄer.",
      "ZberaÅ¥ ovocie, bylinky a zeleninu.",
      "ZastrihÃ¡vaÅ¥ odkvitnutÃ© kvety.",
      "ChrÃ¡niÅ¥ rastliny pred Å¡kodcami."
    ],
    jesen: [
      "ZbieraÅ¥ Ãºrodu a zakladaÅ¥ kompost.",
      "SadiÅ¥ cesnak a cibuÄ¾u na jar.",
      "UprataÅ¥ zÃ¡hony.",
      "ZazimovaÅ¥ citlivÃ© rastliny."
    ],
    zima: [
      "PlÃ¡novaÅ¥ vÃ½sadbu na jar.",
      "ÄŒistiÅ¥ a opravovaÅ¥ nÃ¡radie.",
      "KontrolovaÅ¥ uskladnenÃº Ãºrodu.",
      "StaraÅ¥ sa o izbovÃ© rastliny."
      "nehaj tu zahradu napokoji."
    ],
  };

  const seasonContent = document.getElementById('seasonContent');
  const seasonButtons = document.querySelectorAll('.season-selector button');

  function setSeason(season) {
    seasonButtons.forEach(btn => btn.classList.remove('active'));
    document.querySelector(`[data-season="${season}"]`).classList.add('active');
    seasonContent.innerHTML = `<ul>${tips[season].map(t => `<li>${t}</li>`).join('')}</ul>`;
  }

  const month = new Date().getMonth();
  if (month >= 2 && month <= 4) setSeason('jar');
  else if (month >= 5 && month <= 7) setSeason('leto');
  else if (month >= 8 && month <= 10) setSeason('jesen');
  else setSeason('zima');

  seasonButtons.forEach(btn => {
    btn.addEventListener('click', () => setSeason(btn.dataset.season));
  });
</script>
</body>
</html>







